# PVEä¸€é”®å®‰è£…è„šæœ¬ä½¿ç”¨è¯´æ˜

## ğŸ“‹ ç‰ˆæœ¬ä¿¡æ¯

- **å½“å‰ç‰ˆæœ¬**: v1.0.5
- **æ„å»ºæ—¶é—´**: 2025-10-13 00:00:00
- **æœ€åæ›´æ–°**: é‡ç½®ä¸ºåˆå§‹ç‰ˆæœ¬ï¼Œåˆ é™¤å¤šä½™è„šæœ¬

## ğŸ“ è„šæœ¬æ–‡ä»¶è¯´æ˜

æœ¬é¡¹ç›®æä¾›PVEä¸€é”®å®‰è£…è„šæœ¬ï¼š

### pve_install.sh - ä¸»å®‰è£…è„šæœ¬ (v1.4.0)
- **åŠŸèƒ½å…¨é¢**ï¼šåŒ…å«å®Œæ•´çš„æ—¥å¿—è®°å½•ã€é”™è¯¯å¤„ç†ã€çŠ¶æ€æ£€æµ‹
- **é€‚ç”¨åœºæ™¯**ï¼šç”Ÿäº§ç¯å¢ƒã€é—®é¢˜æ’æŸ¥ã€å¼€å‘è°ƒè¯•
- **ç‰¹ç‚¹**ï¼š
  - è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—
  - è‡ªåŠ¨å¤‡ä»½åŠŸèƒ½
  - æ‰§è¡Œæµç¨‹è·Ÿè¸ª
  - é”™è¯¯åˆ†æ
  - å®‰è£…ç»“æœéªŒè¯

## ğŸ”§ ç‰ˆæœ¬ç®¡ç†

### è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç†
é¡¹ç›®é›†æˆäº†è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼š

- **Git Hook**: æ¯æ¬¡ `git push` æ—¶è‡ªåŠ¨é€’å¢ç‰ˆæœ¬å·
- **æ‰‹åŠ¨ç®¡ç†**: ä½¿ç”¨ `auto_version.sh` è„šæœ¬æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬å·
- **ç‰ˆæœ¬æ ¼å¼**: ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬

### ç‰ˆæœ¬ç®¡ç†å·¥å…·

**æ™ºèƒ½æäº¤**ï¼ˆæ¨èï¼‰ï¼š
```bash
# ä½¿ç”¨æ™ºèƒ½æäº¤è„šæœ¬ï¼Œè‡ªåŠ¨æ·»åŠ ç‰ˆæœ¬å·
./smart_commit.sh "feat: æ·»åŠ æ–°åŠŸèƒ½"
./smart_commit.sh "fix: ä¿®å¤bug"
./smart_commit.sh "docs: æ›´æ–°æ–‡æ¡£"
```

**è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç†**ï¼š
```bash
# æ¯æ¬¡git pushæ—¶è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
git push origin main  # è‡ªåŠ¨é€’å¢ç‰ˆæœ¬å·
```

**æ‰‹åŠ¨ç‰ˆæœ¬ç®¡ç†**ï¼š
```bash
# æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬å·
./auto_version.sh         # é€’å¢ä¿®è®¢ç‰ˆæœ¬ (1.0.0 -> 1.0.1)
./auto_version.sh minor   # é€’å¢æ¬¡ç‰ˆæœ¬ (1.0.0 -> 1.1.0)
./auto_version.sh major   # é€’å¢ä¸»ç‰ˆæœ¬ (1.0.0 -> 2.0.0)
```

### ç‰ˆæœ¬å†å²
- **v1.4.2** (2025-10-13): æ·»åŠ æ™ºèƒ½æäº¤è„šæœ¬å’Œå¤‡ä»½æ£€æŸ¥åŠŸèƒ½
- **v1.4.1** (2025-01-15): æ·»åŠ è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿ
- **v1.4.0** (2025-01-15): ç®€åŒ–é¡¹ç›®ç»“æ„ï¼Œåªä¿ç•™è°ƒè¯•ç‰ˆæœ¬
- **v1.3.0**: ä¿®å¤çŠ¶æ€æ£€æµ‹å‡½æ•°è¿”å›å€¼é—®é¢˜
- **v1.2.0**: æ·»åŠ è°ƒè¯•ç‰ˆæœ¬å’Œè¯¦ç»†æ—¥å¿—
- **v1.1.0**: ä¿®å¤è„šæœ¬æ‰§è¡Œé€»è¾‘é—®é¢˜
- **v1.0.0**: åˆå§‹ç‰ˆæœ¬å‘å¸ƒ

## ä½¿ç”¨æ–¹æ³•

### æ¨èä½¿ç”¨æ–¹å¼

**æ¨èä½¿ç”¨**ï¼š
```bash
# ä¸‹è½½å¹¶æ‰§è¡Œä¸»å®‰è£…è„šæœ¬
curl -L https://raw.githubusercontent.com/wevebeen/onestep/main/pve_install.sh -o pve_install.sh && chmod +x pve_install.sh && bash pve_install.sh
```

**ä¸€é”®æ‰§è¡Œ**ï¼š
```bash
# ç›´æ¥æ‰§è¡Œï¼ˆæ— éœ€ä¸‹è½½æ–‡ä»¶ï¼‰
bash <(curl -L https://raw.githubusercontent.com/wevebeen/onestep/main/pve_install.sh)
```

## ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **CPU**ï¼šx86_64 æˆ– ARM64
- **å†…å­˜**ï¼šè‡³å°‘2GBï¼ˆæ¨è4GB+ï¼‰
- **å­˜å‚¨**ï¼šè‡³å°‘20GBå¯ç”¨ç©ºé—´
- **ç½‘ç»œ**ï¼šç¨³å®šçš„ç½‘ç»œè¿æ¥

### è½¯ä»¶è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**ï¼šDebian 12+ï¼ˆæ¨èï¼‰
- **æƒé™**ï¼šrootæƒé™
- **ç½‘ç»œ**ï¼šèƒ½å¤Ÿè®¿é—®GitHubå’Œé•œåƒæº

## å®‰è£…æµç¨‹

### å®Œæ•´å®‰è£…æµç¨‹
1. **ç¯å¢ƒæ£€æŸ¥**ï¼šæ£€æŸ¥ç³»ç»Ÿã€æƒé™ã€ç½‘ç»œ
2. **ç¬¬ä¸€æ¬¡æ‰§è¡Œ**ï¼šä¸‹è½½å¹¶æ‰§è¡ŒPVEå®‰è£…è„šæœ¬
3. **æ¨¡æ‹Ÿé‡å¯**ï¼šåˆ›å»ºé‡å¯æ ‡è®°æ–‡ä»¶
4. **ç¬¬äºŒæ¬¡æ‰§è¡Œ**ï¼šç»§ç»­æ‰§è¡ŒPVEå®‰è£…
5. **åç«¯é…ç½®**ï¼šæ‰§è¡Œåç«¯é…ç½®è„šæœ¬
6. **éªŒè¯å®‰è£…**ï¼šæ£€æŸ¥å®‰è£…ç»“æœ
7. **æ¸…ç†æ–‡ä»¶**ï¼šæ¸…ç†ä¸´æ—¶æ–‡ä»¶

### å…³é”®æ–‡ä»¶è¯´æ˜
- `/usr/local/bin/reboot_pve.txt`ï¼šé‡å¯æ ‡è®°æ–‡ä»¶
- `/usr/local/bin/build_backend_pve.txt`ï¼šåç«¯é…ç½®æ ‡è®°æ–‡ä»¶
- `install.log`ï¼šå®‰è£…æ—¥å¿—æ–‡ä»¶ï¼ˆå®Œæ•´ç‰ˆæœ¬ï¼‰

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. æƒé™é—®é¢˜**
```bash
# ç¡®ä¿ä»¥rootç”¨æˆ·æ‰§è¡Œ
sudo bash pve_install.sh
```

**2. ç½‘ç»œé—®é¢˜**
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping 8.8.8.8
ping github.com
```

**3. å­˜å‚¨ç©ºé—´ä¸è¶³**
```bash
# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h
# æ¸…ç†ä¸å¿…è¦çš„æ–‡ä»¶
apt clean
```

**4. å†…å­˜ä¸è¶³**
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h
# å¢åŠ swapç©ºé—´
fallocate -l 2G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
```

### æ‰‹åŠ¨æ¢å¤

**å¦‚æœå®‰è£…ä¸­æ–­**ï¼š
```bash
# æ£€æŸ¥å½“å‰çŠ¶æ€
ls -la /usr/local/bin/reboot_pve.txt
ls -la /usr/local/bin/build_backend_pve.txt

# æ‰‹åŠ¨æ¸…ç†æ ‡è®°æ–‡ä»¶
rm -f /usr/local/bin/reboot_pve.txt
rm -f /usr/local/bin/build_backend_pve.txt

# é‡æ–°æ‰§è¡Œå®‰è£…
bash pve_install.sh
```

## å®‰è£…åé…ç½®

### è®¿é—®PVE
- **Webç•Œé¢**ï¼šhttps://æœåŠ¡å™¨IP:8006
- **ç”¨æˆ·å**ï¼šroot
- **å¯†ç **ï¼šæœåŠ¡å™¨rootå¯†ç 

### åŸºæœ¬é…ç½®
1. **æ›´æ–°ç³»ç»Ÿ**ï¼šåœ¨PVE Webç•Œé¢ä¸­æ›´æ–°ç³»ç»Ÿ
2. **é…ç½®å­˜å‚¨**ï¼šæ·»åŠ å­˜å‚¨æ± 
3. **ç½‘ç»œé…ç½®**ï¼šæ£€æŸ¥ç½‘ç»œè®¾ç½®
4. **åˆ›å»ºè™šæ‹Ÿæœº**ï¼šå¼€å§‹ä½¿ç”¨PVE

### å®‰å…¨å»ºè®®
1. **æ›´æ”¹é»˜è®¤å¯†ç **ï¼šä¿®æ”¹rootå¯†ç 
2. **é…ç½®é˜²ç«å¢™**ï¼šé™åˆ¶è®¿é—®ç«¯å£
3. **å®šæœŸå¤‡ä»½**ï¼šå¤‡ä»½é‡è¦é…ç½®
4. **ç›‘æ§ç³»ç»Ÿ**ï¼šç›‘æ§ç³»ç»ŸçŠ¶æ€

## æŠ€æœ¯æ”¯æŒ

### æ—¥å¿—æ–‡ä»¶
- **å®Œæ•´ç‰ˆæœ¬**ï¼šæŸ¥çœ‹ `install.log` æ–‡ä»¶
- **ç³»ç»Ÿæ—¥å¿—**ï¼šæŸ¥çœ‹ `/var/log/syslog`
- **PVEæ—¥å¿—**ï¼šæŸ¥çœ‹ `/var/log/pve/`

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹PVEç‰ˆæœ¬
pveversion

# æŸ¥çœ‹PVEçŠ¶æ€
systemctl status pveproxy

# æŸ¥çœ‹ç½‘ç»œé…ç½®
ip addr show
ip route show

# æŸ¥çœ‹å­˜å‚¨
pvesm status
```

### è”ç³»æ”¯æŒ
å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. ç³»ç»Ÿä¿¡æ¯ï¼ˆ`uname -a`ï¼‰
2. å®‰è£…æ—¥å¿—ï¼ˆ`install.log`ï¼‰
3. é”™è¯¯ä¿¡æ¯æˆªå›¾
4. æ‰§è¡Œçš„å…·ä½“å‘½ä»¤

## network_fix.sh - ç½‘ç»œç¯å¢ƒæ£€æµ‹ä¸ä¿®å¤è„šæœ¬ (v1.5.0)

### åŠŸèƒ½ç‰¹æ€§
- **å…¨é¢ç½‘ç»œç¯å¢ƒæ£€æµ‹**: 14ä¸ªæ£€æµ‹é¡¹ç›®ï¼ŒåŒ…æ‹¬ç³»ç»Ÿä¿¡æ¯ã€ç½‘ç»œæ¥å£ã€è·¯ç”±è¡¨ã€DNSã€é˜²ç«å¢™ã€ç«¯å£ç›‘å¬ã€è¿æ¥çŠ¶æ€ã€ç½‘ç»œç»Ÿè®¡ã€ARPè¡¨ã€è¿é€šæ€§æµ‹è¯•ã€é…ç½®æ–‡ä»¶ã€ç³»ç»Ÿèµ„æºã€ç½‘ç»œè¿›ç¨‹ç­‰
- **äº¤äº’å¼èœå•ç³»ç»Ÿ**: æä¾›5ä¸ªåŠŸèƒ½é€‰é¡¹çš„ç”¨æˆ·å‹å¥½ç•Œé¢
- **å¤‡ä»½ç½‘ç»œç¯å¢ƒ**: åˆ›å»ºå¸¦å¤‡æ³¨çš„ç½‘ç»œé…ç½®å¤‡ä»½
- **æ£€æµ‹22ç«¯å£**: æ£€æµ‹SSHç«¯å£æ˜¯å¦å¼€æ”¾ï¼ˆä»…æ˜¾ç¤ºæˆåŠŸç»“æœï¼‰
- **æ¢å¤ç½‘ç»œé…ç½®**: ä»å¤‡ä»½ä¸­æ¢å¤ç½‘ç»œé…ç½®
- **å‘½ä»¤è¡Œæ”¯æŒ**: æ”¯æŒç›´æ¥æ‰§è¡ŒæŒ‡å®šåŠŸèƒ½

### ä½¿ç”¨æ–¹æ³•
```bash
# å¯åŠ¨äº¤äº’å¼èœå•
bash network_fix.sh

# æŸ¥çœ‹å¸®åŠ©
bash network_fix.sh help

# å…¨é¢æŸ¥çœ‹ç½‘ç»œç¯å¢ƒ
bash network_fix.sh view

# å¤‡ä»½å½“å‰ç½‘ç»œç¯å¢ƒ
bash network_fix.sh backup

# æ£€æµ‹22ç«¯å£
bash network_fix.sh check

# æ¢å¤ç½‘ç»œé…ç½®
bash network_fix.sh restore
```

### èœå•é€‰é¡¹
1. **å…¨é¢æŸ¥çœ‹ç½‘ç»œç¯å¢ƒ** - 14ä¸ªæ£€æµ‹é¡¹ç›®çš„å…¨é¢ç½‘ç»œç¯å¢ƒåˆ†æ
2. **å¤‡ä»½å½“å‰ç½‘ç»œç¯å¢ƒ** - åˆ›å»ºå¸¦å¤‡æ³¨çš„ç½‘ç»œé…ç½®å¤‡ä»½
3. **æ£€æµ‹22ç«¯å£** - æ£€æµ‹SSHç«¯å£å¤–ç½‘è®¿é—®æ€§ï¼ˆä»…æ˜¾ç¤ºæˆåŠŸï¼‰
4. **æ¢å¤ç½‘ç»œé…ç½®** - ä»å¤‡ä»½ä¸­æ¢å¤ç½‘ç»œé…ç½®
5. **é€€å‡º** - é€€å‡ºè„šæœ¬

### è¾“å‡ºæ–‡ä»¶
- **å¤‡ä»½ç›®å½•**: `$HOME/network_backup/`
- **æ—¥å¿—æ–‡ä»¶**: `$HOME/network_fix.log`

## æ›´æ–°æ—¥å¿—

### v1.5.0 (2025-01-15)
- âœ… æ¢å¤äº¤äº’å¼èœå•ç³»ç»Ÿ
- âœ… å¤§å¹…å¢å¼ºç½‘ç»œç¯å¢ƒæ£€æµ‹åŠŸèƒ½ï¼ˆ14ä¸ªæ£€æµ‹é¡¹ç›®ï¼‰
- âœ… æ·»åŠ å…¨é¢çš„ç½‘ç»œç¯å¢ƒåˆ†æ
- âœ… æ”¯æŒèœå•å’Œå‘½ä»¤è¡Œä¸¤ç§ä½¿ç”¨æ–¹å¼
- âœ… ä¼˜åŒ–èœå•é€»è¾‘ï¼Œé¿å…æ­»å¾ªç¯é—®é¢˜

### v1.4.0 (2025-01-15)
- âœ… ç®€åŒ–è„šæœ¬åŠŸèƒ½ï¼Œç§»é™¤è‡ªåŠ¨æ£€æµ‹å’Œå¤æ‚èœå•
- âœ… æ”¯æŒå‘½ä»¤è¡Œå‚æ•°ç›´æ¥æ‰§è¡ŒåŠŸèƒ½
- âœ… ä¼˜åŒ–å¤‡ä»½å’Œæ¢å¤åŠŸèƒ½
- âœ… ä¿®å¤æ­»å¾ªç¯é—®é¢˜

### v1.1.0 (2025-01-15)
- âœ… æ·»åŠ äº¤äº’å¼èœå•ç³»ç»Ÿ
- âœ… å®ç°å¸¦å¤‡æ³¨çš„ç½‘ç»œé…ç½®å¤‡ä»½åŠŸèƒ½
- âœ… æ·»åŠ ç½‘ç»œé…ç½®æŸ¥çœ‹åŠŸèƒ½
- âœ… å®ç°æ™ºèƒ½ç½‘ç»œé…ç½®æ¢å¤åŠŸèƒ½
- âœ… ä¼˜åŒ–SSHç«¯å£æ£€æµ‹ï¼Œä»…æ˜¾ç¤ºæˆåŠŸç»“æœ
- âœ… æ”¯æŒå‘½ä»¤è¡Œå‚æ•°ç›´æ¥æ‰§è¡ŒåŠŸèƒ½
- âœ… æ·»åŠ ç”¨æˆ·ç¡®è®¤æœºåˆ¶é˜²æ­¢è¯¯æ“ä½œ
- âœ… å®Œå–„å¤‡ä»½ä¿¡æ¯è®°å½•å’Œé”™è¯¯å¤„ç†

### v1.0.5 (2025-01-15)
- âœ… æ·»åŠ ç½‘ç»œç¯å¢ƒæ£€æµ‹ä¸ä¿®å¤è„šæœ¬
- âœ… æ”¯æŒå…¨é¢çš„ç½‘ç»œè¯Šæ–­å’Œä¿®å¤åŠŸèƒ½
- âœ… é›†æˆç¬¬ä¸‰æ–¹APIç«¯å£æ£€æµ‹
- âœ… æ”¯æŒäº‘æœåŠ¡å•†ç¯å¢ƒæ£€æµ‹
- âœ… ç”Ÿæˆè¯¦ç»†çš„è¯Šæ–­æŠ¥å‘Š

### v1.0 (2025-01-15)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒ4ç§ä¸åŒå®‰è£…æ¨¡å¼
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… æ™ºèƒ½çŠ¶æ€æ£€æµ‹å’Œæ–­ç‚¹ç»­ä¼ 
- âœ… è¯¦ç»†çš„å®‰è£…éªŒè¯å’Œæ•…éšœæ’é™¤
